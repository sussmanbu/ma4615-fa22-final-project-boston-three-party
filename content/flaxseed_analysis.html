---
title: Flaxseed Analysis
description: 
toc: true
featuredVideo: 
featuredImage: 
draft: false
---


<div id="TOC">

</div>

<p>This comes from the file <code>content/flaxseed_analysis.Rmd</code>.</p>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
## ✔ readr   2.1.2      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## Loading required package: forecast</code></pre>
<pre><code>## Warning: package &#39;forecast&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## Warning: One or more parsing issues, see `problems()` for details</code></pre>
<pre><code>## Rows: 47 Columns: 9
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (8): h, Year, Area planted, Area harvested, Yield per acre, Production, ...
## dbl (1): 5
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## Warning: One or more parsing issues, see `problems()` for details</code></pre>
<pre><code>## Rows: 39 Columns: 9
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (8): h, Year, Area planted, Area harvested, Yield per acre, Production, ...
## dbl (1): 10
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
## New names:</code></pre>
<pre><code>## Warning: The following named parsers don&#39;t match the column names: t, Crop Production Historical Track Records: Released April 11, 2022, by the National Agricultural Statistics Service (NASS), Agricultural Statistics Board, United States Department of Agriculture (USDA).
## One or more parsing issues, see `problems()` for details</code></pre>
<pre><code>## New names:
## • `` -&gt; `...3`
## • `(1,000 acres)` -&gt; `(1,000 acres)...4`
## • `(1,000 acres)` -&gt; `(1,000 acres)...5`</code></pre>
<pre><code>## Warning: The following named parsers don&#39;t match the column names: t, Crop Production Historical Track Records: Released April 11, 2022, by the National Agricultural Statistics Service (NASS), Agricultural Statistics Board, United States Department of Agriculture (USDA).
## One or more parsing issues, see `problems()` for details</code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   `Area planted` = col_double()
## )</code></pre>
<pre><code>## Warning: `type_convert()` only converts columns of type &#39;character&#39;.
## - `df` has no columns of type &#39;character&#39;</code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols()</code></pre>
<pre class="r"><code>Year &lt;- flaxseed_co2_data %&gt;% pull(Time)
Production &lt;- flaxseed_co2_data %&gt;% pull(Production)
co_emit &lt;- flaxseed_co2_data %&gt;% pull(CO2_emissions_kt)

flaxseed_ts &lt;- ggplot(flaxseed_co2_data, aes(x=Year, y=Production)) +
  geom_line() +
  xlab(&quot;&quot;)
flaxseed_ts</code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_timeseries-1.png" width="672" /></p>
<p>In our time series analysis above, we analyze the production of flaxseed over time.</p>
<pre class="r"><code>ggAcf(flaxseed_co2_data$`Area harvested`)  ###use difference </code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_stats-1.png" width="672" /></p>
<pre class="r"><code>ggAcf(diff(flaxseed_co2_data$`Area harvested`)) ## no autocorrelation</code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_stats-2.png" width="672" /></p>
<pre class="r"><code># co2 emission
ggAcf(flaxseed_co2_data$CO2_emissions_kt) ##persistent  autocorrelation </code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_stats-3.png" width="672" /></p>
<pre class="r"><code>ggAcf(diff(flaxseed_co2_data$CO2_emissions_kt)) #increase of c02 over time, a good plot</code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_stats-4.png" width="672" /></p>
<pre class="r"><code>#flaxseed_co2_data %&gt;% ggplot(aes(x = diff(&#39;Area harvested&#39;), y = diff(CO2_emissions_kt))) + geom_point()

diff_df &lt;- data.frame(diff_area = diff(flaxseed_co2_data$`Area harvested`), diff_co2 = diff(flaxseed_co2_data$CO2_emissions_kt) )
diff_df %&gt;% ggplot(aes(x = diff_area, y = diff_co2)) + geom_point()+ geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_stats-5.png" width="672" /></p>
<pre class="r"><code>### weak correlation between co2 and harvested

flaxseed_co2_data %&gt;% ggplot(aes(x = `Area harvested`, y = CO2_emissions_kt)) + geom_point()+ geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_stats-6.png" width="672" /></p>
<pre class="r"><code>##there is very strong correlation here

lm2 &lt;- (lm(`Area harvested`~ CO2_emissions_kt, flaxseed_co2_data)) 
summary(lm2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = `Area harvested` ~ CO2_emissions_kt, data = flaxseed_co2_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -275.45 -160.57  -36.51  104.06  570.14 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)      1.762e+02  1.331e+02   1.323    0.196
## CO2_emissions_kt 3.628e-05  2.600e-05   1.395    0.173
## 
## Residual standard error: 194.1 on 30 degrees of freedom
## Multiple R-squared:  0.06093,    Adjusted R-squared:  0.02962 
## F-statistic: 1.946 on 1 and 30 DF,  p-value: 0.1732</code></pre>
<pre class="r"><code>#High correlation

lm2_diff &lt;-lm(diff_area ~ diff_co2, diff_df) 
summary(lm2_diff)</code></pre>
<pre><code>## 
## Call:
## lm(formula = diff_area ~ diff_co2, data = diff_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -417.76  -83.54   -9.55   96.79  444.03 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  1.116e-02  2.922e+01   0.000    1.000
## diff_co2    -3.025e-06  3.331e-05  -0.091    0.928
## 
## Residual standard error: 160.1 on 29 degrees of freedom
## Multiple R-squared:  0.0002842,  Adjusted R-squared:  -0.03419 
## F-statistic: 0.008245 on 1 and 29 DF,  p-value: 0.9283</code></pre>
<pre class="r"><code>#differenced data has no correlation, differencing is not required

ggAcf(lm2$residuals)</code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_stats-7.png" width="672" /></p>
<pre class="r"><code>ggAcf(lm2_diff$residuals)</code></pre>
<p><img src="/flaxseed_analysis_files/figure-html/flaxseed_stats-8.png" width="672" /></p>
